<!doctype html><html lang=es dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor | Javi Vela Blog</title><meta name=keywords content="dev tools,Visual Studio Code,contenedores"><meta name=description content="En algunas ocasiones es algo tedioso instalar los SDKs o dependencias de un proyecto para poder trabajar con √©l. Visual Studio Code Dev Containers te permite definir y distribuir el entorno de desarrollo de tu proyecto."><meta name=author content="Javi Vela"><link rel=canonical href=https://blog.javivela.dev/posts/2022/devtools/desarrolla-en-un-contenedor/><meta name=google-site-verification content="Z9k5TW79n5H64zWLwEcNkbNITNDDepKoE2udZjirxXM"><meta name=msvalidate.01 content="6A293DF736526A40A24D911811A73F7D"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.javivela.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.javivela.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.javivela.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.javivela.dev/apple-touch-icon.png><link rel=mask-icon href=https://blog.javivela.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=es href=https://blog.javivela.dev/posts/2022/devtools/desarrolla-en-un-contenedor/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.javivela.dev/posts/2022/devtools/desarrolla-en-un-contenedor/"><meta property="og:site_name" content="Javi Vela Blog"><meta property="og:title" content="Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor"><meta property="og:description" content="En algunas ocasiones es algo tedioso instalar los SDKs o dependencias de un proyecto para poder trabajar con √©l. Visual Studio Code Dev Containers te permite definir y distribuir el entorno de desarrollo de tu proyecto."><meta property="og:locale" content="es"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-30T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-30T00:00:00+00:00"><meta property="article:tag" content="Dev Tools"><meta property="article:tag" content="Visual Studio Code"><meta property="article:tag" content="Contenedores"><meta property="og:image" content="https://blog.javivela.dev/papermod-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.javivela.dev/papermod-cover.png"><meta name=twitter:title content="Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor"><meta name=twitter:description content="En algunas ocasiones es algo tedioso instalar los SDKs o dependencias de un proyecto para poder trabajar con √©l. Visual Studio Code Dev Containers te permite definir y distribuir el entorno de desarrollo de tu proyecto."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.javivela.dev/posts/"},{"@type":"ListItem","position":2,"name":"Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor","item":"https://blog.javivela.dev/posts/2022/devtools/desarrolla-en-un-contenedor/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor","name":"Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor","description":"En algunas ocasiones es algo tedioso instalar los SDKs o dependencias de un proyecto para poder trabajar con √©l. Visual Studio Code Dev Containers te permite definir y distribuir el entorno de desarrollo de tu proyecto.","keywords":["dev tools","Visual Studio Code","contenedores"],"articleBody":"Introducci√≥n Al comenzar un nuevo proyecto es necesario instalar SDKs o otras dependencias necesarias para desarrollar y ejecutar el proyecto, al principio es muy f√°cil recordar todos los pasos necesarios pero con el paso del tiempo seguramente ya no est√©n tan claros los pasos a seguir o qu√© dependencias son necesarias. Los Readme son muy √∫tiles pero no automatizan el proceso de instalaci√≥n y seguramente no se hayan actualizado correctamente.\nOtro escenario bastante com√∫n en nuestro d√≠a a d√≠a es trabajar en varios proyectos a la vez y con diferentes SDKs y dependencias entre ellos.\n¬øTe imaginas poder distribuir y mantener versionado un entorno de desarrollo al igual que versionas y distribuyes una aplicaci√≥n? Si, es posible. Visual Studio Code y el plugin Visual Studio Code Dev Containers te permite crear y utilizar un contenedor docker para instalar los requisitos necesarios para desarrollar, ejecutar y depurar tu aplicaci√≥n.\nDev Container La configuraci√≥n del contendor de desarrollo se define en el fichero devcontainer.json dentro de la carpeta .devcontainer (no olvides el punto üòÑ) en el fichero puedes definir:\nImagen docker a utilizar, fichero docker a construir o fichero docker compose a utilizar Instalar herramientas Instalar extensiones de Visual Studio Code Definir puertos Definir argumentos y configuraci√≥n por defecto Cuando el contenedor est√° arrancado, se monta la carpeta de tu proyecto (volume mount) y se instala Visual Studio Code Server en el contenedor con la configuraci√≥n indicada en el fichero.\nA continuaci√≥n vamos a configurar un contenedor de desarrollo para el proyecto terraform provider for confluent cloud, para poder desarrollar el proyecto es necesario (puedes encontrar aqui todos los requisitos):\nGo 1.18 (to build the provider plugin) Terraform \u003e= 0.14 Docker para ejecutar los test de aceptaci√≥n Recomendado utilizar Terraform version manager tfutils/tfenv Para comenzar partiremos del repositorio de ejemplo para proyectos go https://github.com/Microsoft/vscode-remote-try-go. Al abrir el fichero devcontainer.json podemos diferenciar tres secciones: build, runArgs y customizations.\nEl objeto build permite definir c√≥mo se va a construir nuestra imagen de desarrollo, en el siguiente ejemplo definimos que se va a utilizar el fichero docker Dockerfile indicando tambi√©n los argumentos necesarios para construir la imagen. En el caso de que la imagen no est√© almacenada localmente, se construir√° la imagen con la configuraci√≥n indicada.\n\"build\": { \"dockerfile\": \"Dockerfile\", \"args\": { \"VARIANT\": \"1.18-bullseye\", \"NODE_VERSION\": \"lts/*\" } Tambi√©n podemos utilizar una imagen ya creada (propiedad image) almacenada en un docker image registry (Docker Hub, Azure Container Registry,‚Ä¶), para utilizar un fichero docker compose debemos utilizar la propiedad dockerComposeFile\nrunArgs permite definir un array de argumentos que se utilizar√°n para ejecutar la imagen de desarrollo:\n\"runArgs\": [ \"--cap-add=SYS_PTRACE\", \"--security-opt\", \"seccomp=unconfined\" ], customizations define la configuraci√≥n de la instancia de Visual Studio Code, puedes encontrar las herramientas y servicios soportados aqui:\n\"customizations\": { \"vscode\": { \"settings\": { \"go.toolsManagement.checkForUpdates\": \"local\", \"go.useLanguageServer\": true, \"go.gopath\": \"/go\", \"go.goroot\": \"/usr/local/go\" }, \"extensions\": [ \"golang.Go\" ] } } Una vez creado el fichero devcontainer.json, Visual Studio Code lo detectar√° cuando abrimos la carpeta del proyecto y nos preguntar√° si deseamos abrir nuestra carpeta usando el contendor. Una vez abierto, autom√°ticamente comenzar√° a construir la imagen en caso de que fuera necesario:\nEjecutamos los siguientes comandos para compilar el m√≥dulo y comprobar si nuestro contenedor de desarrollo funciona correctamente:\nmake deps make build Para poder ejecutar los test de aceptaci√≥n (make testacc) es necesario tener instalado docker. Al estar trabajando dentro de un contenedor necesitamos habilitar docker in docker, permite a nuestro contenedor que se conecte al socket de docker de nuestra m√°quina y de esta manera podremos crear contenedores desde nuestro contenedor de desarrollo.\nPodemos encontrar el script necesario en el siguiente enlace https://github.com/microsoft/vscode-dev-containers/tree/main/containers/docker-in-docker una vez integrado en nuestro proyecto podemos utilizar docker desde nuestro contenedor. Los contenedores se ejecutar√°n en la m√°quina host.\nPuedes encontrar todo la configuraci√≥n necesaria en el siguiente enlace: https://github.com/fjvela/terraform-provider-confluent/commit/f12fc48d89cf3ceea77a2f7b8d7e791f59d255df\nDev Container Features El 15 de septiembre de 2022 se lanz√≥ Custom Dev Container Features, esta funcionalidad simplifica enormemente la configuraci√≥n de nuestros contenedores de desarrollo permiti√©ndonos habilitar y deshabilitar Features desde el archivo devcontainer.json sin necesidad de a√±adir o eliminar scripts a nuestro contenedor.\nPor ejemplo para habilitar la funcionalidad docker in docker tan solo es necesario habilitar la funcionalidad docker-in-docker, anteriormente hemos necesitado incluir y adaptar varios ficheros de configuraci√≥n:\n\"ghcr.io/devcontainers/features/docker-in-docker:1\": { \"version\": \"latest\", \"moby\": true } Cada Dev Container Feature se distribuye como tarballs, cada uno de ellos contiene al menos dos ficheros:\ninstall.sh: Script de instalaci√≥n, se a√±ade como una nueva capa de la imagen y se ejecuta durante la construcci√≥n de la imagen devcontainer-feature.json: Contiene informaci√≥n sobre la Feature y contiene opciones que pueden pasarse como argumentos al script install.sh Finalmente con menos de 20 l√≠neas podemos configurar nuestro proyecto para utilizar Dev Container Features y poder distribuir y versionar nuestro entorno de desarrollo:\n{ \"name\": \"Go\", \"image\": \"mcr.microsoft.com/devcontainers/base:ubuntu\", // Any generic, debian-based image. \"features\": { \"ghcr.io/devcontainers/features/go:1\": { \"version\": \"1.18\" }, \"ghcr.io/devcontainers/features/docker-in-docker:1\": { \"version\": \"latest\", \"moby\": true }, \"ghcr.io/devcontainers/features/terraform:1\": {}, \"ghcr.io/devcontainers/features/git:1\": {} }, // Uncomment to connect as a non-root user. More info: https://aka.ms/vscode-remote/containers/non-root. \"remoteUser\": \"vscode\" } Puedes encontrar todo la configuraci√≥n necesaria en el siguiente enlace: https://github.com/fjvela/terraform-provider-confluent/commit/b0cc3b1a2e60b67424901596da3c0770866dff51\nReferencias https://code.visualstudio.com/docs/devcontainers/tutorial https://code.visualstudio.com/docs/devcontainers/create-dev-container https://github.com/microsoft/vscode-dev-containers https://github.com/Microsoft/vscode-remote-try-go https://github.com/devcontainers https://containers.dev/features ","wordCount":"852","inLanguage":"es","image":"https://blog.javivela.dev/papermod-cover.png","datePublished":"2022-11-30T00:00:00Z","dateModified":"2022-11-30T00:00:00Z","author":{"@type":"Person","name":"Javi Vela"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.javivela.dev/posts/2022/devtools/desarrolla-en-un-contenedor/"},"publisher":{"@type":"Organization","name":"Javi Vela Blog","logo":{"@type":"ImageObject","url":"https://blog.javivela.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.javivela.dev/ accesskey=h title="Javi Vela Blog (Alt + H)">Javi Vela Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://blog.javivela.dev/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://blog.javivela.dev/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://blog.javivela.dev/archives/ title=Archivos><span>Archivos</span></a></li><li><a href=https://blog.javivela.dev/search/ title=Buscar><span>Buscar</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.javivela.dev/>Inicio</a>&nbsp;¬ª&nbsp;<a href=https://blog.javivela.dev/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor</h1><div class=post-meta><span title='2022-11-30 00:00:00 +0000 UTC'>noviembre 30, 2022</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;Javi Vela</div></header><div class=post-content><h2 id=introducci√≥n>Introducci√≥n<a hidden class=anchor aria-hidden=true href=#introducci√≥n>#</a></h2><p>Al comenzar un nuevo proyecto es necesario instalar SDKs o otras dependencias necesarias para desarrollar y ejecutar el proyecto, al principio es muy f√°cil recordar todos los pasos necesarios pero con el paso del tiempo seguramente ya no est√©n tan claros los pasos a seguir o qu√© dependencias son necesarias. Los <em>Readme</em> son muy √∫tiles pero no automatizan el proceso de instalaci√≥n y seguramente no se hayan actualizado correctamente.</p><p>Otro escenario bastante com√∫n en nuestro d√≠a a d√≠a es trabajar en varios proyectos a la vez y con diferentes SDKs y dependencias entre ellos.</p><p>¬øTe imaginas poder distribuir y mantener versionado un entorno de desarrollo al igual que versionas y distribuyes una aplicaci√≥n?<br>Si, es posible. <a href=https://code.visualstudio.com/>Visual Studio Code</a> y el plugin <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers">Visual Studio Code Dev Containers</a> te permite crear y utilizar un contenedor docker para instalar los requisitos necesarios para desarrollar, ejecutar y depurar tu aplicaci√≥n.</p><h2 id=dev-container>Dev Container<a hidden class=anchor aria-hidden=true href=#dev-container>#</a></h2><p>La configuraci√≥n del contendor de desarrollo se define en el fichero devcontainer.json dentro de la carpeta .devcontainer (no olvides el punto üòÑ) en el fichero puedes definir:</p><ul><li>Imagen docker a utilizar, fichero docker a construir o fichero docker compose a utilizar</li><li>Instalar herramientas</li><li>Instalar extensiones de Visual Studio Code</li><li>Definir puertos</li><li>Definir argumentos y configuraci√≥n por defecto</li></ul><p>Cuando el contenedor est√° arrancado, se monta la carpeta de tu proyecto (volume mount) y se instala Visual Studio Code Server en el contenedor con la configuraci√≥n indicada en el fichero.</p><p><img alt="Arquitectura Visual Studio Code Dev Containers" loading=lazy src=/2022/devtools/architecture-containers.png></p><p>A continuaci√≥n vamos a configurar un contenedor de desarrollo para el proyecto <a href=https://github.com/confluentinc/terraform-provider-confluent><em>terraform provider for confluent cloud</em></a>, para poder desarrollar el proyecto es necesario (puedes encontrar <a href=https://github.com/confluentinc/terraform-provider-confluent/blob/master/docs/DEVELOPING.md>aqui</a> todos los requisitos):</p><ul><li>Go 1.18 (to build the provider plugin)</li><li>Terraform >= 0.14</li><li>Docker para ejecutar los test de aceptaci√≥n</li><li>Recomendado utilizar Terraform version manager tfutils/tfenv</li></ul><p>Para comenzar partiremos del repositorio de ejemplo para proyectos go <a href=https://github.com/Microsoft/vscode-remote-try-go>https://github.com/Microsoft/vscode-remote-try-go</a>. Al abrir el fichero <em>devcontainer.json</em> podemos diferenciar tres secciones: <strong><em>build</em></strong>, <strong><em>runArgs</em></strong> y <strong><em>customizations</em></strong>.</p><p>El objeto <strong><em>build</em></strong> permite definir c√≥mo se va a construir nuestra imagen de desarrollo, en el siguiente ejemplo definimos que se va a utilizar el fichero docker <em>Dockerfile</em> indicando tambi√©n los argumentos necesarios para construir la imagen. En el caso de que la imagen no est√© almacenada localmente, se construir√° la imagen con la configuraci√≥n indicada.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;build&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;dockerfile&#34;</span>: <span style=color:#e6db74>&#34;Dockerfile&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;args&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;VARIANT&#34;</span>: <span style=color:#e6db74>&#34;1.18-bullseye&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;NODE_VERSION&#34;</span>: <span style=color:#e6db74>&#34;lts/*&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>Tambi√©n podemos utilizar una imagen ya creada (propiedad <a href=https://containers.dev/implementors/json_reference/#image-specific><strong><em>image</em></strong></a>) almacenada en un docker image registry (Docker Hub, Azure Container Registry,&mldr;), para utilizar un fichero docker compose debemos utilizar la propiedad <a href=https://containers.dev/implementors/json_reference/#compose-specific><strong><strong>dockerComposeFile</strong></strong></a></p><p><strong><em>runArgs</em></strong> permite definir un array de argumentos que se utilizar√°n para ejecutar la imagen de desarrollo:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;runArgs&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> [ <span style=color:#e6db74>&#34;--cap-add=SYS_PTRACE&#34;</span>, <span style=color:#e6db74>&#34;--security-opt&#34;</span>, <span style=color:#e6db74>&#34;seccomp=unconfined&#34;</span> ]<span style=color:#960050;background-color:#1e0010>,</span>
</span></span></code></pre></div><p><strong><em>customizations</em></strong> define la configuraci√≥n de la instancia de Visual Studio Code, puedes encontrar las herramientas y servicios soportados <a href=https://containers.dev/supporting>aqui</a>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;customizations&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;vscode&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;settings&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;go.toolsManagement.checkForUpdates&#34;</span>: <span style=color:#e6db74>&#34;local&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;go.useLanguageServer&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;go.gopath&#34;</span>: <span style=color:#e6db74>&#34;/go&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;go.goroot&#34;</span>: <span style=color:#e6db74>&#34;/usr/local/go&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;extensions&#34;</span>: [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;golang.Go&#34;</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Una vez creado el fichero <em>devcontainer.json</em>, Visual Studio Code lo detectar√° cuando abrimos la carpeta del proyecto y nos preguntar√° si deseamos abrir nuestra carpeta usando el contendor. Una vez abierto, autom√°ticamente comenzar√° a construir la imagen en caso de que fuera necesario:</p><p><img alt="Notificaci√≥n Visual Studio Code reabrir carpeta en contenedor " loading=lazy src=/2022/devtools/visual-code-notification-reopen-in-container.png>
<img alt="Logs construcci√≥n del contenedor" loading=lazy src=/2022/devtools/build-container.png></p><p>Ejecutamos los siguientes comandos para compilar el m√≥dulo y comprobar si nuestro contenedor de desarrollo funciona correctamente:</p><ul><li>make deps</li><li>make build</li></ul><p>Para poder ejecutar los test de aceptaci√≥n (make testacc) es necesario tener instalado docker. Al estar trabajando dentro de un contenedor necesitamos habilitar docker in docker, permite a nuestro contenedor que se conecte al socket de docker de nuestra m√°quina y de esta manera podremos crear contenedores desde nuestro contenedor de desarrollo.</p><p>Podemos encontrar el script necesario en el siguiente enlace <a href=https://github.com/microsoft/vscode-dev-containers/tree/main/containers/docker-in-docker>https://github.com/microsoft/vscode-dev-containers/tree/main/containers/docker-in-docker</a> una vez integrado en nuestro proyecto podemos utilizar docker desde nuestro contenedor. Los contenedores se ejecutar√°n en la m√°quina host.</p><p><img alt="Resultado ejecuci√≥n &lsquo;make build&rsquo;" loading=lazy src=/2022/devtools/results-build.png>
<img alt="Resultado ejecuci√≥n &lsquo;make testacc&rsquo;" loading=lazy src=/2022/devtools/results-test-accep.png></p><p>Puedes encontrar todo la configuraci√≥n necesaria en el siguiente enlace: <a href=https://github.com/fjvela/terraform-provider-confluent/commit/f12fc48d89cf3ceea77a2f7b8d7e791f59d255df>https://github.com/fjvela/terraform-provider-confluent/commit/f12fc48d89cf3ceea77a2f7b8d7e791f59d255df</a></p><h2 id=dev-container-features>Dev Container Features<a hidden class=anchor aria-hidden=true href=#dev-container-features>#</a></h2><p>El 15 de septiembre de 2022 se lanz√≥ <a href=https://code.visualstudio.com/blogs/2022/09/15/dev-container-features>Custom Dev Container Features</a>, esta funcionalidad simplifica enormemente la configuraci√≥n de nuestros contenedores de desarrollo permiti√©ndonos habilitar y deshabilitar Features desde el archivo devcontainer.json sin necesidad de a√±adir o eliminar scripts a nuestro contenedor.</p><p>Por ejemplo para habilitar la funcionalidad docker in docker tan solo es necesario habilitar la funcionalidad <em><strong>docker-in-docker</strong></em>, anteriormente hemos necesitado incluir y adaptar varios ficheros de configuraci√≥n:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>   <span style=color:#e6db74>&#34;ghcr.io/devcontainers/features/docker-in-docker:1&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;latest&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;moby&#34;</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    } 
</span></span></code></pre></div><p>Cada Dev Container Feature se distribuye como <em><strong>tarballs</strong></em>, cada uno de ellos contiene al menos dos ficheros:</p><ul><li><strong><em>install.sh</em></strong>: Script de instalaci√≥n, se a√±ade como una nueva capa de la imagen y se ejecuta durante la construcci√≥n de la imagen</li><li><strong><em>devcontainer-feature.json</em></strong>: Contiene informaci√≥n sobre la Feature y contiene opciones que pueden pasarse como argumentos al script <strong><em>install.sh</em></strong></li></ul><p>Finalmente con menos de 20 l√≠neas podemos configurar nuestro proyecto para utilizar Dev Container Features y poder distribuir y versionar nuestro entorno de desarrollo:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Go&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;image&#34;</span>: <span style=color:#e6db74>&#34;mcr.microsoft.com/devcontainers/base:ubuntu&#34;</span>,  <span style=color:#75715e>// Any generic, debian-based image.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;features&#34;</span>: {
</span></span><span style=display:flex><span>		<span style=color:#f92672>&#34;ghcr.io/devcontainers/features/go:1&#34;</span>: {
</span></span><span style=display:flex><span>			<span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;1.18&#34;</span>
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#f92672>&#34;ghcr.io/devcontainers/features/docker-in-docker:1&#34;</span>: {
</span></span><span style=display:flex><span>			<span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;latest&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#f92672>&#34;moby&#34;</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#f92672>&#34;ghcr.io/devcontainers/features/terraform:1&#34;</span>: {},
</span></span><span style=display:flex><span>		<span style=color:#f92672>&#34;ghcr.io/devcontainers/features/git:1&#34;</span>: {}
</span></span><span style=display:flex><span>	},
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Uncomment to connect as a non-root user. More info: https://aka.ms/vscode-remote/containers/non-root.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#f92672>&#34;remoteUser&#34;</span>: <span style=color:#e6db74>&#34;vscode&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Puedes encontrar todo la configuraci√≥n necesaria en el siguiente enlace: <a href=https://github.com/fjvela/terraform-provider-confluent/commit/b0cc3b1a2e60b67424901596da3c0770866dff51>https://github.com/fjvela/terraform-provider-confluent/commit/b0cc3b1a2e60b67424901596da3c0770866dff51</a></p><h3 id=referencias>Referencias<a hidden class=anchor aria-hidden=true href=#referencias>#</a></h3><ul><li><a href=https://code.visualstudio.com/docs/devcontainers/tutorial>https://code.visualstudio.com/docs/devcontainers/tutorial</a></li><li><a href=https://code.visualstudio.com/docs/devcontainers/create-dev-container>https://code.visualstudio.com/docs/devcontainers/create-dev-container</a></li><li><a href=https://github.com/microsoft/vscode-dev-containers>https://github.com/microsoft/vscode-dev-containers</a></li><li><a href=https://github.com/Microsoft/vscode-remote-try-go>https://github.com/Microsoft/vscode-remote-try-go</a></li><li><a href=https://github.com/devcontainers>https://github.com/devcontainers</a></li><li><a href=https://containers.dev/features>https://containers.dev/features</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.javivela.dev/tags/dev-tools/>Dev Tools</a></li><li><a href=https://blog.javivela.dev/tags/visual-studio-code/>Visual Studio Code</a></li><li><a href=https://blog.javivela.dev/tags/contenedores/>Contenedores</a></li></ul><nav class=paginav><a class=prev href=https://blog.javivela.dev/posts/2022/kubernetes/azure-key-vault-secret-store-csi/><span class=title>¬´ Anterior</span><br><span>Azure Key Vault Provider for Secrets Store CSI Driver, leyendo y utilizando informaci√≥n de un Azure Key Vault desde AKS</span>
</a><a class=next href=https://blog.javivela.dev/posts/2022/kubernetes/startup-probe/><span class=title>Siguiente ¬ª</span><br><span>Kubernetes: Startup probe</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor on x" href="https://x.com/intent/tweet/?text=Mejora%20la%20experiencia%20de%20desarrollo%2c%20desarrolla%20dentro%20de%20un%20contenedor&amp;url=https%3a%2f%2fblog.javivela.dev%2fposts%2f2022%2fdevtools%2fdesarrolla-en-un-contenedor%2f&amp;hashtags=devtools%2cVisualStudioCode%2ccontenedores"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.javivela.dev%2fposts%2f2022%2fdevtools%2fdesarrolla-en-un-contenedor%2f&amp;title=Mejora%20la%20experiencia%20de%20desarrollo%2c%20desarrolla%20dentro%20de%20un%20contenedor&amp;summary=Mejora%20la%20experiencia%20de%20desarrollo%2c%20desarrolla%20dentro%20de%20un%20contenedor&amp;source=https%3a%2f%2fblog.javivela.dev%2fposts%2f2022%2fdevtools%2fdesarrolla-en-un-contenedor%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.javivela.dev%2fposts%2f2022%2fdevtools%2fdesarrolla-en-un-contenedor%2f&title=Mejora%20la%20experiencia%20de%20desarrollo%2c%20desarrolla%20dentro%20de%20un%20contenedor"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.javivela.dev%2fposts%2f2022%2fdevtools%2fdesarrolla-en-un-contenedor%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor on whatsapp" href="https://api.whatsapp.com/send?text=Mejora%20la%20experiencia%20de%20desarrollo%2c%20desarrolla%20dentro%20de%20un%20contenedor%20-%20https%3a%2f%2fblog.javivela.dev%2fposts%2f2022%2fdevtools%2fdesarrolla-en-un-contenedor%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor on telegram" href="https://telegram.me/share/url?text=Mejora%20la%20experiencia%20de%20desarrollo%2c%20desarrolla%20dentro%20de%20un%20contenedor&amp;url=https%3a%2f%2fblog.javivela.dev%2fposts%2f2022%2fdevtools%2fdesarrolla-en-un-contenedor%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Mejora la experiencia de desarrollo, desarrolla dentro de un contenedor on ycombinator" href="https://news.ycombinator.com/submitlink?t=Mejora%20la%20experiencia%20de%20desarrollo%2c%20desarrolla%20dentro%20de%20un%20contenedor&u=https%3a%2f%2fblog.javivela.dev%2fposts%2f2022%2fdevtools%2fdesarrolla-en-un-contenedor%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.javivela.dev/>Javi Vela Blog</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a> &
<a href=https://librecounter.org/ rel=noopener target=_blank>LibreCounter</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><img src=https://librecounter.org/counter.svg referrerpolicy=unsafe-url width=0>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copiar";function s(){t.innerHTML="¬°copiado!",setTimeout(()=>{t.innerHTML="copiar"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>